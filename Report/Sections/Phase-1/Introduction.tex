The innate abilities that human beings possess to process complex things effortlessly in daily life are impressive. To translate even the fractional part of one of these abilities of the human being into a machine is a challenging task in itself. One such ability of human beings is to navigate in a social environment. For example, when we walk in a crowded public space we follow a large number of common-sense rules and social etiquette. Which includes respecting the personal space of others, yielding right-of-way, avoiding walking through the people belonging to the same group, taking the shortest or safer path to the destination, and much more.


This ability of ours in the field of technology is commonly known as Human/Pedestrian trajectory prediction. The task of predicting human trajectories is crucial for current and future technological advancements. There are already many applications that make intensive use of modeling the pedestrians motion data and social interactions, e.g. infrastructure design (urban safety, city planning) \cite{Hanisch2003OnlineSO, Lerner2007CrowdsBE, Bitgood2006AnAO}, traffic operations \cite{Horni2016TheMT}, autonomous driving, are just a few to name. Typically, this modeling is performed in an offline manner by gathering the pedestrian motion data beforehand and completing the analysis to make decisions for the improvements in the environment. In modern world applications, however, one needs to perform this in real-time, allowing one to predict the pedestrian moves and infer their short or mid-term intentions in the environment. That allows to take preventive actions and trigger the alarm for the monitoring system in critical real-time decision-making applications. As in the case of autonomous driving, finding the intention of the pedestrians surrounding the car is of paramount importance in avoiding collisions. The task of modeling social interactions is extremely challenging as there exists no fixed set of rules which govern human motion. Here we refer to this task of predicting the human motion as Pedestrian trajectory prediction.


Many approaches have been proposed and developed to solve this complex task. In general, they can be classified into two categories: deterministic and statistical. The deterministic methods use hand-crafted functions based on certain observable conditions, such as Newton's laws of motion (which use velocity and acceleration to calculate position) and shortest paths (with the assumption that humans prefer the shortest path to the target position), etc., to generate human motion trajectories. A far-reaching example is social forces, a model proposed by Helbing and Molnar~\cite{Helbing95} based on equations describing the relationship between main effects (including attractive forces from goal and repulsive forces from other agents and obstacles) and human motion. Yi~\cite{Yi15} built a model to calculate the optimal path for humans based on the formulated energy map. On the other hand, statistical ways rely on learning patterns from data through various methods, such as neural networks, Hidden Markov Models, etc. In 2015, Zhou et al.~\cite{Zhou} build a linear dynamic system, applying the Expectation-Maximization (EM) algorithm to estimate parameters, to learn motion patterns in crowded scenes. Altch√©~\cite{Altche17} proposes a method that predicts the trajectory on the highway using Long Short-Term Memory (LSTM). Alahi et al.~\cite{Alahi16} give a sequence model based on LSTM as well as a social pooling that aggregates the human-human interaction in a scene. With the vast amount of data available today, these methods can model complex situations that are difficult for humans to observe, which is valuable information for predicting the behavior of pedestrians. Thus, this approach is gaining more and more popularity in the research field.


Over the past few years, the statistical approaches have really helped us make better predictions about human trajectories. However, these methods mentioned previously learn only the pattern of human motion from data. Predicting human trajectory is a complex task. This is because both internal and external stimuli, such as intentions and other directly or indirectly observable influences, can affect human motion, as mentioned in the survey~\cite{humanmotionsurvey}. In addition to the location, which is usually recorded in the dataset, many factors that are not explicitly recorded in the dataset, such as speed, direction, or even not recorded, such as route and human intent. Recent researches have shown that Generative Adversarial Network (GAN) can better capture these uncertainties with latent space and thus naturally preserve multimodality. Gupta et al.~\cite{Gupta_2018_CVPR} used GAN and a Pooling Module to predict socially acceptable trajectories and found that certain directions in the latent space are related to direction and velocity. What is more, the study of Amirian et al.~\cite{Amirian_2019_CVPR_Workshops} has shown that InfoGAN, an information-theoretic extension to the Generative Adversarial Network~\cite{infogan}, partly improves the performance on commonly used datasets that have the largest variance in the prediction distribution, while still leaving some room for improvement.

Even though these researches give various effective models that fulfill the prediction task and attempt to encompass hidden aspects that influence the trajectory, they have not disentangled these factors in the latent space. Suppose we know the factors that affect pedestrians' trajectories and apply these factors in specific scenarios. We can obtain better performance of prediction on various distributed datasets and mitigate the limitations of the observed data. Therefore, we decide to consider the hidden factors behind different datasets.


In this study, our aim is not to improve the prediction of human motion but to bridge the gap of not disentangling the factors that influence human motion trajectories in the GAN model. We are interested in the relationship between human trajectories and those hidden factors that are not described by the data. We want to disentangle these factors from the latent space, and, ideally, with these factors, we can have a general model that works on different datasets. We assume that different datasets have different static environments, and so the data in a dataset share some specific common features. We consider three factors that may exist between different datasets: (that can be different between different datasets): obstacles (obstacles information such as the presence of static obstacles and the coordinates), maps (geometry and topology), and semantics (environment semantics such as no-go-zones, crosswalks, sidewalks, or traffic lights), which are the cues (in a static environment) that influence human trajectories, denoted by the survey~\cite{humanmotionsurvey}.

We summarize our research questions as follows:

\begin{itemize}
  \item What factors we can obtain that influence human trajectories?
  \item Can the factors we consider describe the variances between datasets? That is, with these factors input to our model, can our model gain better performance for different datasets?
\end{itemize}

Based on the problems, we propose to develop a controllable generative model to predict human motion. It can be controlled by factor $c$ to have different static environments. We demonstrate that human movement is influenced by these three factors that we consider in a static environment. Also, by inputting different factors in static environments, our model can achieve better performance on different datasets.
